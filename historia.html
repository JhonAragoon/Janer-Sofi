<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuestra Historia de Amor</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <!-- Icono de corazón para la carta flotante -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --color-primary: #ff6b6b;
            --color-secondary: #ffecef;
            --color-dark: #333;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            overflow-x: hidden;
            /* Fondo principal del body */
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('img/hf.jpg') no-repeat center center fixed;
            background-size: cover;
            color: white;
            line-height: 1.6;
            height: 100vh;
            perspective: 1000px;
        }
        
        /* Fondo animado (solo para PC) */
        .bg-parallax {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: url('img/ojos.jpg') no-repeat center center fixed; /* Fondo de ojos */
            background-size: cover;
            transform-style: preserve-3d;
            will-change: transform;
        }
        
        /* Encabezado */
        header {
            position: relative;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 0 20px;
            z-index: 1;
        }
        
        h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 5rem;
            margin-bottom: 20px;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        .contador-amor {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 50px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .contador {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .tiempo-box {
            background: var(--color-primary);
            color: white;
            padding: 20px;
            border-radius: 15px;
            min-width: 100px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }
        
        .tiempo-box:hover {
            transform: translateY(-5px) scale(1.05);
        }
        
        .tiempo-box span {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }
        
        /* Botones */
        .botones {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: var(--color-primary);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        /* Línea de tiempo horizontal */
        .timeline-container {
            position: relative;
            padding: 100px 0;
            height: 100vh;
            display: flex;
            flex-direction: column; /* Para apilar la línea de tiempo y los botones */
            justify-content: center;
            align-items: center;
            /* Fondo para la sección de la línea de tiempo */
            background: rgba(0, 0, 0, 0.5); /* Fondo semitransparente */
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .timeline {
            display: flex;
            overflow-x: scroll;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            padding: 0 50px;
            height: 80%;
            align-items: center;
            scrollbar-width: none; /* Firefox */
            width: 100%; /* Asegura que ocupe todo el ancho disponible */
        }
        
        .timeline::-webkit-scrollbar {
            display: none; /* Chrome/Safari */
        }
        
        .momentos {
            display: flex;
            gap: 50px;
            padding: 0 100px;
        }
        
        .momento {
            scroll-snap-align: center;
            min-width: 400px;
            height: 500px;
            position: relative;
            transition: all 0.5s ease;
            flex-shrink: 0;
            transform-style: preserve-3d;
        }
        
        .momento::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.8) 100%);
            border-radius: 20px;
            z-index: 1;
        }
        
        .momento-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            transition: all 0.5s ease;
        }
        
        .momento video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }
        
        .momento-contenido {
            position: absolute;
            bottom: 0;
            left: 0;
            padding: 30px;
            width: 100%;
            z-index: 2;
            transform-origin: bottom;
            transition: all 0.5s ease;
        }
        
        .momento:hover .momento-img {
            transform: scale(1.03);
        }
        
        .momento:hover .momento-contenido {
            transform: translateY(-20px) scale(1.05);
        }
        
        .momento-fecha {
            color: var(--color-primary);
            margin-bottom: 10px;
            font-weight: bold;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        /* Línea central */
        .timeline-line {
            position: absolute;
            left: 0;
            top: 50%;
            width: 100%;
            height: 2px;
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-50%);
        }
        
        /* Flechas de navegación */
        .nav-arrows {
            position: absolute; /* Posicionamiento absoluto dentro del timeline-container */
            top: 50%;
            left: 0;
            right: 0;
            transform: translateY(-50%);
            display: flex;
            justify-content: space-between; /* Para que estén en los extremos */
            padding: 0 20px; /* Espacio desde los bordes */
            z-index: 10;
            pointer-events: none; /* Permite hacer clic a través del div si no hay botones */
        }
        
        .arrow {
            width: 60px; /* Más grandes para PC */
            height: 60px; /* Más grandes para PC */
            background: rgba(255, 107, 107, 0.8);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: none;
            color: white;
            font-size: 2rem; /* Más grande para PC */
            pointer-events: auto; /* Habilita clics en los botones */
        }
        
        .arrow:hover {
            transform: scale(1.1);
            background: var(--color-primary);
        }
        
        /* Carta Flotante */
        .carta-flotante {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            background: var(--color-primary);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            z-index: 100;
            transition: transform 0.3s ease, background 0.3s ease;
            animation: pulse 2s infinite; /* Animación de pulsación */
        }

        .carta-flotante:hover {
            transform: scale(1.1);
            background: #ff4d4d;
        }

        .carta-flotante i {
            color: white;
            font-size: 2.5rem;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Modal de la Carta */
        .modal-carta {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-carta.visible {
            opacity: 1;
            visibility: visible;
        }

        .carta-contenido {
            background: #fff; /* Color de papel */
            color: var(--color-dark);
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            max-width: 700px;
            width: 90%;
            position: relative;
            transform: scale(0.8); /* Empieza pequeña para la animación */
            opacity: 0;
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55), opacity 0.5s ease;
            font-family: 'Montserrat', sans-serif; /* Fuente para la carta */
            font-size: 1.1rem; /* Ajuste para el contenido */
            line-height: 1.8; /* Ajuste para el contenido */
            text-align: center;
            overflow-y: auto; /* Para permitir scroll si el contenido es largo */
            max-height: 90vh; /* Limita la altura para que quepa en la pantalla */
        }

        .modal-carta.visible .carta-contenido {
            transform: scale(1);
            opacity: 1;
        }

        .carta-contenido h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 2rem; /* Ajuste para el contenido */
            color: var(--color-primary);
            margin-bottom: 20px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .carta-contenido p {
            margin-bottom: 15px;
            font-size: 1rem; /* Ajuste para el contenido */
        }

        .cerrar-carta {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--color-dark);
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .cerrar-carta:hover {
            color: var(--color-primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 3rem;
            }
            
            .contador-amor {
                padding: 20px;
                width: 90%;
            }
            
            .momento {
                min-width: 300px;
                height: 400px;
            }
            
            .momentos {
                gap: 30px;
                padding: 0 50px;
            }
            
            .momento-contenido {
                padding: 20px;
            }

            /* Ajustes específicos para móviles */
            body {
                background-attachment: scroll; 
            }

            .bg-parallax {
                display: none; /* Oculta completamente el fondo de ojos en móvil */
            }

            .tiempo-box {
                min-width: 80px; 
                padding: 15px; 
            }

            .tiempo-box span {
                font-size: 1.5rem; 
            }

            .tiempo-box small {
                font-size: 0.8rem; 
            }

            .btn {
                padding: 12px 25px; 
                font-size: 1rem; 
            }

            .nav-arrows {
                padding: 0 10px; /* Reduce el padding en móvil */
            }

            .arrow {
                width: 40px; /* Reduce el tamaño de las flechas */
                height: 40px;
                font-size: 1.2rem; /* Reduce el tamaño del icono de la flecha */
            }

            /* Carta Flotante en móvil */
            .carta-flotante {
                width: 60px;
                height: 60px;
                bottom: 20px;
                right: 20px;
            }
            .carta-flotante i {
                font-size: 2rem;
            }

            /* Modal de la Carta en móvil */
            .carta-contenido {
                padding: 25px;
                font-size: 1.1rem; /* Ajuste para el contenido en móvil */
            }
            .carta-contenido h2 {
                font-size: 1.8rem;
            }
            .carta-contenido p {
                font-size: 0.9rem;
            }
            .cerrar-carta {
                font-size: 1.8rem;
            }
        }

        /* Media query para pantallas muy pequeñas (ej. iPhone SE) */
        @media (max-width: 480px) {
            h1 {
                font-size: 2.5rem;
            }
            .contador {
                gap: 10px; 
            }
            .tiempo-box {
                min-width: 70px;
                padding: 10px;
            }
            .tiempo-box span {
                font-size: 1.2rem;
            }
            .tiempo-box small {
                font-size: 0.7rem;
            }
            .momento {
                min-width: 280px; 
                height: 350px; 
            }
            .momento-contenido {
                padding: 15px; 
            }

            /* Carta Flotante en pantallas muy pequeñas */
            .carta-flotante {
                width: 50px;
                height: 50px;
                bottom: 15px;
                right: 15px;
            }
            .carta-flotante i {
                font-size: 1.8rem;
            }

            /* Modal de la Carta en pantallas muy pequeñas */
            .carta-contenido {
                padding: 20px;
                font-size: 1rem;
            }
            .carta-contenido h2 {
                font-size: 1.5rem;
            }
            .carta-contenido p {
                font-size: 0.8rem;
            }
            .cerrar-carta {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Verificar desbloqueo -->
    <script>
        if(!localStorage.getItem('desbloqueado')) {
            window.location.href = "index.html";
        }
    </script>

    <!-- Fondo con efecto parallax -->
    <div class="bg-parallax" id="bgParallax"></div>
    
    <header>
        <h1>Nuestra Historia</h1>
        <p>Cada momento contigo es un tesoro</p>
        
        <div class="contador-amor">
            <h2>Llevamos juntos</h2>
            <div class="contador">
                <div class="tiempo-box">
                    <span id="meses">00</span>
                    <small>Meses</small>
                </div>
                <div class="tiempo-box">
                    <span id="dias">00</span>
                    <small>Días</small>
                </div>
                <div class="tiempo-box">
                    <span id="horas">00</span>
                    <small>Horas</small>
                </div>
                <div class="tiempo-box">
                    <span id="minutos">00</span>
                    <small>Minutos</small>
                </div>
                <div class="tiempo-box">
                    <span id="segundos">00</span>
                    <small>Segundos</small>
                </div>
            </div>
            
            <!-- Botones para navegar -->
            <div class="botones">
                <button class="btn" id="btn-dibujitos">Nuestros Dibujitos</button>
            </div>
        </div>
    </header>
    
    <!-- Línea de tiempo horizontal -->
    <div class="timeline-container">
        <div class="timeline-line"></div>
        <div class="timeline" id="timeline">
            <div class="momentos">
                <!-- Recuerdos -->
                <div class="momento">
                    <img src="img/h1.jpg" alt="Sofi pequeña" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Pequeña</h3>
                        <p>Cuando estabas chitita</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h2.jpg" alt="Janer pequeño" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Pequeño</h3>
                        <p>Cuando estaba chitito</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h3.jpg" alt="Primera foto juntos" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Nuestra primera foto juntos</h3>
                        <p>Recuerdo ese día como si fuera ayer, nuestra primera foto juntos.</p>
                    </div>
                </div>
                <div class="momento">
                    <video src="videos/v3.mp4" autoplay loop muted loading="lazy"></video>
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Videito Juntos</h3>
                        <p>Cada dia que paso contigo es....</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h4.jpg" alt="Foto graciosa" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Una foto graciosa</h3>
                        <p>Nos divertimos mucho en ese lugar, ¡qué risa!</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h5.jpg" alt="Primeras flores" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Las primeras flores</h3>
                        <p>Las primeras flores que le regalé, un momento especial.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h6.jpg" alt="Regalo de Sofi" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Un regalo especial</h3>
                        <p>Un regalo que me hizo, siempre lo atesoraré.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h7.jpg" alt="Picnic Improvizado" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Un Picnic</h3>
                        <p>Un momento chevere que tuvimos.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h8.jpg" alt="Comiendo juntos" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Foto comiendo</h3>
                        <p>Una de nuestras comidas favoritas juntos.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h9.jpg" alt="Sentados juntos" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Juntos y felices</h3>
                        <p>Una foto que nos tomaron sentados juntos, disfrutando del momento.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h10.jpg" alt="En la piscina" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Día en la piscina</h3>
                        <p>Un día divertido en la piscina, ¡qué buenos recuerdos!</p>
                    </div>
                </div>
                <div class="momento">
                    <video src="videos/v1.mp4" autoplay loop muted loading="lazy"></video>
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Fiesta juntos</h3>
                        <p>Una fiesta inolvidable, siempre bailando juntos.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h11.jpg" alt="Más fotos juntos" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Más momentos juntos</h3>
                        <p>Más instantes que hemos compartido juntos.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h12.jpg" alt="Más fotos juntos" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Más momentos juntos</h3>
                        <p>Más instantes que hemos compartido juntos.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h13.jpg" alt="Más fotos juntos" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Más momentos juntos</h3>
                        <p>Más instantes que hemos compartido juntos.</p>
                    </div>
                </div>
                <div class="momento">
                    <video src="videos/v2.mp4" autoplay loop muted loading="lazy"></video>
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">Noche de cocteles</h3>
                        <p>Una noche mágica en nuestra segunda salida juntos.</p>
                    </div>
                </div>
                <div class="momento">
                    <img src="img/h14.jpg" alt="Otra foto juntos" class="momento-img" loading="lazy">
                    <div class="momento-contenido">
                        <h3 class="momento-fecha">otra foto</h3>
                        <p>Disfrutando de un delicioso helado juntos.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Flechas de navegación -->
        <div class="nav-arrows">
            <button class="arrow" id="prev-momento">◄</button>
            <button class="arrow" id="next-momento">►</button>
        </div>
    </div>

    <!-- Carta Flotante -->
    <div class="carta-flotante" id="cartaFlotante">
        <i class="fas fa-envelope-open-text"></i> <!-- Icono de carta abierta -->
    </div>

    <!-- Modal de la Carta -->
    <div class="modal-carta" id="modalCarta">
        <div class="carta-contenido">
            <button class="cerrar-carta" id="cerrarCarta">&times;</button>
            <h2>Sofi,</h2>
            <p>Te quiero dedicar estas palabras:</p>
            <p>Amarte no fue una decisión, fue algo que simplemente sucedió desde el primer momento. Amo cada detalle tuyo, incluso aquellos que tú no notas. Me encanta estar contigo, porque se siente tan natural, como si todo encajara sin esfuerzo. No busco nada forzado: busco tu compañía, tu risa, tus silencios, tu manera de reírte de mis loqueras… en fin, todo lo que eres.</p>
            <p>Te amo de una forma que las palabras apenas alcanzan a explicar, pero que mi corazón no se cansa de sentir. No sé si sientes lo mismo, pero si existe la mínima posibilidad de que esto sea mutuo, quiero intentarlo todas las veces que sea necesario.</p>
            <p>No espero nada a cambio, porque el amor verdadero no se trata de exigir, sino de dar desde lo más genuino. Solo contigo siento esa paz: con una palabra tuya puedes calmar mis pensamientos, y eso no me pasa con nadie más.</p>
            <p>Si algún día llego a ser importante para ti, quisiera tener un lugarcito en tu corazón. Como siempre te digo: dale tiempo al tiempo. Sé que todo son planes de la vida, pero deseo que me des la oportunidad de que me conozcas mejor y descubras que mi forma de amar y mi manera de pensar son diferentes.</p>
            <p>Prometo cuidar de ti en tus alegrías y en tus momentos difíciles. Con todo mi amor,</p>
            <p>Janer 💙</p>
        </div>
    </div>
    
    <script>
        // Contador de tiempo juntos
        function iniciarContador() {
            const fechaInicio = new Date("2025-02-22T00:00:00"); // CAMBIA ESTA FECHA Y HORA
            
            function actualizar() {
                const ahora = new Date();
                const dif = ahora - fechaInicio; // Diferencia en milisegundos
                
                // Cálculos para meses, días, horas, minutos, segundos
                const segundosTotales = Math.floor(dif / 1000);
                const minutosTotales = Math.floor(segundosTotales / 60);
                const horasTotales = Math.floor(minutosTotales / 60);
                const diasTotales = Math.floor(horasTotales / 24);
                
                // Para meses, necesitamos un cálculo más preciso ya que los meses tienen diferentes días
                // Una aproximación común es usar 30.44 días por mes (365.25 / 12)
                const meses = Math.floor(diasTotales / 30.44);
                const diasRestantes = Math.floor(diasTotales % 30.44); // Días después de los meses completos
                
                const horas = horasTotales % 24;
                const minutos = minutosTotales % 60;
                const segundos = segundosTotales % 60;
                
                document.getElementById('meses').textContent = meses.toString().padStart(2, '0');
                document.getElementById('dias').textContent = diasRestantes.toString().padStart(2, '0');
                document.getElementById('horas').textContent = horas.toString().padStart(2, '0');
                document.getElementById('minutos').textContent = minutos.toString().padStart(2, '0');
                document.getElementById('segundos').textContent = segundos.toString().padStart(2, '0');
            }
            
            actualizar();
            setInterval(actualizar, 1000); // Actualizar cada segundo
        }
        
        // Efecto parallax
        function initParallax() {
            const bgParallax = document.getElementById('bgParallax');
            
            // Solo aplica el efecto parallax en pantallas más grandes (no móviles)
            if (window.innerWidth > 768) { /* Usamos 768px como breakpoint para móviles */
                window.addEventListener('scroll', () => {
                    const scrollPosition = window.pageYOffset;
                    bgParallax.style.transform = `translateY(${scrollPosition * 0.4}px)`;
                });
            } else {
                // Asegura que el fondo no se mueva en móviles si el JS se ejecuta antes del CSS
                bgParallax.style.transform = 'none';
                bgParallax.style.position = 'absolute';
                bgParallax.style.backgroundAttachment = 'scroll';
            }
        }
        
        // Navegación horizontal de la línea de tiempo
        function initTimelineNavigation() {
            const timeline = document.getElementById('timeline');
            const prevBtn = document.getElementById('prev-momento');
            const nextBtn = document.getElementById('next-momento');
            
            // Calcula el ancho del momento dinámicamente, incluyendo el gap
            // Esto es importante porque el ancho del momento y el gap cambian en móviles
            function getMomentoScrollWidth() {
                const momento = document.querySelector('.momento');
                if (!momento) return 0;
                const momentoStyle = window.getComputedStyle(momento);
                const momentoWidth = momento.offsetWidth;
                const momentosContainer = document.querySelector('.momentos');
                const momentosContainerStyle = window.getComputedStyle(momentosContainer);
                const gap = parseFloat(momentosContainerStyle.gap); // Obtiene el valor del gap
                return momentoWidth + gap;
            }

            prevBtn.addEventListener('click', () => {
                timeline.scrollBy({
                    left: -getMomentoScrollWidth(),
                    behavior: 'smooth'
                });
            });
            
            nextBtn.addEventListener('click', () => {
                timeline.scrollBy({
                    left: getMomentoScrollWidth(),
                    behavior: 'smooth'
                });
            });
        }
        
        // Animar momentos al hacer scroll
        function animateMomentsOnScroll() {
            const momentos = document.querySelectorAll('.momento');
            
            function checkVisibility() {
                momentos.forEach(momento => {
                    const rect = momento.getBoundingClientRect();
                    const isVisible = (rect.top <= window.innerHeight * 0.8) && 
                                     (rect.bottom >= window.innerHeight * 0.2);
                    
                    if(isVisible) {
                        momento.style.opacity = '1';
                        momento.style.transform = 'translateY(0) rotateY(0)';
                    } else {
                        if(rect.top > window.innerHeight) {
                            // Momento debajo del viewport
                            momento.style.opacity = '0';
                            momento.style.transform = 'translateY(100px) rotateY(20deg)';
                        } else {
                            // Momento encima del viewport
                            momento.style.opacity = '0';
                            momento.style.transform = 'translateY(-100px) rotateY(-20deg)';
                        }
                    }
                });
            }
            
            // Inicializar con estilos
            momentos.forEach(momento => {
                momento.style.opacity = '0';
                momento.style.transform = 'translateY(100px) rotateY(20deg)';
                momento.style.transition = 'all 0.6s cubic-bezier(0.22, 1, 0.36, 1)';
            });
            
            window.addEventListener('scroll', checkVisibility);
            checkVisibility(); // Verificar al cargar
        }
        
        // Navegación a la página de dibujitos
        document.getElementById('btn-dibujitos').addEventListener('click', function() {
            window.location.href = "dibujitos.html";
        });

        // Funcionalidad de la Carta Flotante
        const cartaFlotante = document.getElementById('cartaFlotante');
        const modalCarta = document.getElementById('modalCarta');
        const cerrarCartaBtn = document.getElementById('cerrarCarta');

        cartaFlotante.addEventListener('click', () => {
            modalCarta.classList.add('visible');
            document.body.style.overflow = 'hidden'; // Evita el scroll del body al abrir el modal
        });

        cerrarCartaBtn.addEventListener('click', () => {
            modalCarta.classList.remove('visible');
            document.body.style.overflow = ''; // Restaura el scroll del body
        });

        // Cerrar modal al hacer clic fuera del contenido de la carta
        modalCarta.addEventListener('click', (e) => {
            if (e.target === modalCarta) {
                modalCarta.classList.remove('visible');
                document.body.style.overflow = '';
            }
        });


        // Iniciar todo
        document.addEventListener('DOMContentLoaded', function() {
            iniciarContador();
            initParallax();
            initTimelineNavigation();
            animateMomentsOnScroll();
        });

        // Re-inicializar parallax y navegación si la ventana cambia de tamaño (ej. rotación de móvil)
        window.addEventListener('resize', () => {
            initParallax(); // Para re-evaluar si el parallax debe estar activo
            // No es necesario re-inicializar initTimelineNavigation o animateMomentsOnScroll
            // ya que sus cálculos son dinámicos o se basan en scroll.
        });
    </script>
</body>
</html>
